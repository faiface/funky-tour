<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>A Tour of Funky</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">var path_to_root = "";</script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="1-taking-off-the-ground.html"><strong aria-hidden="true">1.</strong> Taking off the ground</a></li><li><ol class="section"><li><a href="1-1-installing.html"><strong aria-hidden="true">1.1.</strong> Installing</a></li><li><a href="1-2-hello-world.html"><strong aria-hidden="true">1.2.</strong> Hello, world!</a></li><li><a href="1-3-expressions-and-types.html"><strong aria-hidden="true">1.3.</strong> Expressions and types</a></li><li><a href="1-4-semicolons-and-lambdas.html"><strong aria-hidden="true">1.4.</strong> Semicolons and lambdas</a></li><li><a href="1-5-a-bit-more-about-io.html"><strong aria-hidden="true">1.5.</strong> A bit more about IO</a></li><li><a href="1-6-putting-it-together-a-calculator.html"><strong aria-hidden="true">1.6.</strong> Putting it together: a calculator</a></li></ol></li><li><a href="2-making-the-world-our-own.html"><strong aria-hidden="true">2.</strong> Making the world our own</a></li><li><ol class="section"><li><a href="2-1-functions.html"><strong aria-hidden="true">2.1.</strong> Functions</a></li><li><a href="2-2-records.html"><strong aria-hidden="true">2.2.</strong> Records</a></li><li><a href="2-3-unions.html"><strong aria-hidden="true">2.3.</strong> Unions</a></li><li><a href="2-4-aliases.html"><strong aria-hidden="true">2.4.</strong> Aliases</a></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">A Tour of Funky</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#taking-off-the-ground" id="taking-off-the-ground"><h1>Taking off the ground</h1></a>
<p><a href="https://github.com/faiface/funky">Funky</a> is a new, small programming language that's like and unlike any other language you've seen before.</p>
<p>It's purely functional, doesn't cheat, but unlike most languages in this space, Funky lets you structure your code top to bottom. Idiomatic Funky code often reads like a well-written imperative algorithm. This lends code that is natural to read - yet in the end, it's basically just <a href="https://en.wikipedia.org/wiki/Lambda_calculus">Î»-calculus</a>.</p>
<p>Funky aims for simplicity and joy. No categories, no monads, no weird, abstract, math operators. Nothing unnecessary. Funky is a pragmatic language for programmers.</p>
<blockquote>
<p><strong>A small warning.</strong> Funky was created from <em>scratch</em>. While the standard, battle-tested, functional core, like <code>map</code>, <code>filter</code>, <code>Maybe</code>, etc. will be familiar to all functional programmers, many things will surprise you. For example, as we'll soon discover, <code>let</code> and <code>if</code> are not built-in to the language. Instead, they're functions just like any other. Many more surprises await you in the tour.</p>
</blockquote>
<p>So, here we go!</p>
<a class="header" href="#installing" id="installing"><h1>Installing</h1></a>
<blockquote>
<p><strong>Note.</strong> These instructions are for Linux. If you're on another operating system, you can try to follow them doing analogous actions on your OS.</p>
</blockquote>
<p>Funky is currently implemented in <a href="https://golang.org/">Go</a> and there are no pre-compiled binaries provided yet.</p>
<p>Therefore, the first step is to install the Go language either from the <a href="https://golang.org/">official website</a> or from your package manager.</p>
<p>Go uses <code>$GOPATH</code> directory to download packages and install Go programs. If you installed a recent version of Go, you don't have to set it up, it defaults to <code>~/go</code>.</p>
<p>Next you need to download Funky. You do that with the Go package manager:</p>
<pre><code>$ go get -u github.com/faiface/funky/...
</code></pre>
<p>This downloads Funky repository to the <code>$GOPATH/src</code> directory and installs the binaries to the <code>$GOPATH/bin</code> directory.</p>
<p>To make the binaries easily runnable from the command line, you need to add <code>$GOPATH/bin</code> (or <code>~/go/bin</code> if <code>$GOPATH</code> is not set) to the <code>$PATH</code> environment variable. Add this to your <code>~/.bashrc</code> file (or an equivalent of that for your shell):</p>
<pre><code># replace $GOPATH with /home/yourname/go if $GOPATH is not set up
export PATH=$PATH:$GOPATH/bin
</code></pre>
<p>Now, one last thing. Funky uses the <code>$FUNKY</code> environment variable to indentify the location of the standard library. Add this to your <code>.bashrc</code> file:</p>
<pre><code>export FUNKY=$GOPATH/src/github.com/faiface/funky/stdlib
</code></pre>
<p><strong>And that's it!</strong> Let's get ready for some action!</p>
<a class="header" href="#hello-world" id="hello-world"><h1>Hello, world!</h1></a>
<p>Let's make sure everything works. Open your favorite text editor and put in these lines:</p>
<pre><code class="language-funky">func main : IO =
    println &quot;Hello, world!&quot;;
    quit
</code></pre>
<p>Now hit the command line and type this:</p>
<pre><code>$ funkycmd hello.fn
Hello, world!
</code></pre>
<p>There we go!</p>
<p>It should work. If it doesn't, go back and see if you set everything up correctly. If you did and it still doesn't work, <a href="https://github.com/faiface/funky">file an issue</a>.</p>
<a class="header" href="#expressions-and-types" id="expressions-and-types"><h1>Expressions and types</h1></a>
<p>Funky is a strongly typed language. To explore types, Funky provides a <em>types sandbox</em>. It's kind of like a <a href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a>, but it doesn't evaluate anything - just tells you the types.</p>
<p>Here's how we fire it up:</p>
<pre><code>$ funkycmd -types
&gt;
</code></pre>
<blockquote>
<p><strong>Note.</strong> <code>funkycmd -types</code> currenty doesn't implement convenient things like 'arrow up' to go back to the previous entry, and so on. To get those, I highly recommend using the <code>rlwrap</code> utility. Just install it and run <code>rlwrap funkycmd -types</code> and you'll get all those convenient features.</p>
</blockquote>
<p>It opens up a little prompt where we can type expressions. Let's try it!</p>
<pre><code>$ funkycmd -types
&gt; 5
Int
&gt; 3.14
Float
&gt; pi
Float
&gt; 'x'
Char
</code></pre>
<blockquote>
<p><strong>Details.</strong> Funky has three built-in types: <code>Int</code>, <code>Float</code>, and <code>Char</code>. <code>Int</code>s are arbitrary-precision integers. <code>Float</code>s are IEEE-754 64-bit floating-point numbers. <code>Char</code>s are <a href="https://en.wikipedia.org/wiki/Unicode">Unicode</a> characters. All other types are either from the standard library or defined by the programmer.</p>
</blockquote>
<p>How about using some operators and functions?</p>
<pre><code>&gt; 13 + 48
Int
&gt; sqrt 4
sandbox:1:6: type-checking error
</code></pre>
<p>Ugh, what? A <em>type-checking error</em>? Yeah, that's right.</p>
<blockquote>
<p><strong>Note</strong>. The compiler error messages will get better and more descriptive.</p>
</blockquote>
<pre><code>&gt; sqrt
Float -&gt; Float
&gt; 4
Int
</code></pre>
<p>As we can see, the type of the <code>sqrt</code> function is <code>Float -&gt; Float</code> (a function that takes a <code>Float</code> and returns a <code>Float</code>), while the value we supplied is an <code>Int</code>. This doesn't match. Instead, we need to supply a <code>Float</code> value:</p>
<pre><code>&gt; sqrt 4.0
Float
</code></pre>
<p>Now this works.</p>
<blockquote>
<p><strong>Details.</strong> There are many built-in functions for each of these built-in types. Arithmetic operators (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>^</code>, <code>%</code>), comparison operators (<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>), math functions (<code>sin</code>, <code>cos</code>, <code>sqrt</code>, <code>atan2</code>, etc.), and conversion functions (<code>float</code>, <code>int</code>, etc.). One notable thing is that you can't add characters - <code>'a' + 'b'</code> is not valid - but you can add an integer to a character: <code>'a' + 2</code> results in <code>'c'</code>.</p>
</blockquote>
<blockquote>
<p><strong>Note.</strong> Unary minus is not spelled <code>-</code>, but <code>neg</code>. The reason is that <code>-</code> is always infix because of its name. You can still you <code>-</code> in number literals, like <code>-42</code>.</p>
</blockquote>
<a class="header" href="#printing-various-values" id="printing-various-values"><h2>Printing various values</h2></a>
<p>We've already printed <code>&quot;Hello, world!&quot;</code>, how about printing other stuff? Let's try:</p>
<pre><code class="language-funky">func main : IO =
    println 13;
    quit
</code></pre>
<p>Try running it:</p>
<pre><code>$ funkycmd hello.fn
hello.fn:2:13: type-checking error
</code></pre>
<p>A type-checking error again? Let's see where we went wrong. Start up the types sandbox:</p>
<pre><code>$ funkycmd -types
&gt;
</code></pre>
<p>And let's examine the type of the <code>println</code> function:</p>
<pre><code>&gt; println
String -&gt; IO -&gt; IO
</code></pre>
<p>Oh, so the <code>println</code> function only takes strings. Could've guessed that!</p>
<blockquote>
<p><strong>Note.</strong> Althought it might not seem like it at first, <code>println</code> is a completely pure function. It takes two arguments: a <code>String</code> and an <code>IO</code>. The <code>IO</code> is a continuation - it says what should be done after the string gets printed. In our case, the continuation is <code>quit</code> (which has the type <code>IO</code> itself). This <em>instructs</em> the program to quit after printing the string. The precise workings of this will be explained soon.</p>
</blockquote>
<p>So, how do we convert an <code>Int</code> or a <code>Float</code> to a <code>String</code> so that we can print it?</p>
<p>The <code>string</code> function is for that purpose. Let's see what's the type of this <code>string</code> function:</p>
<pre><code>$ funkycmd -types
&gt; string
Int -&gt; String
Float -&gt; String
Bool -&gt; String
Char -&gt; String
String -&gt; String
</code></pre>
<blockquote>
<p><strong>Details.</strong> <code>Bool</code> and <code>String</code> are not built-in, they're implemented in the standard library.</p>
</blockquote>
<p>Wait, what? The <code>string</code> function has multiple types? That's exactly correct!</p>
<p>Unlike most functional languages, Funky supports <strong>overloading</strong>. That means that you can define many functions with the same name, provided they are <em>distinguishible</em> by their types.</p>
<p>Back to the printing. This now works:</p>
<pre><code class="language-funky">func main : IO =
    println (string 13);
    quit
</code></pre>
<p>Runs as expected:</p>
<pre><code>$ funkycmd hello.fn
13
</code></pre>
<blockquote>
<p><strong>Exercise.</strong> Play with various functions. Try operators like <code>*</code>, <code>^</code>, <code>%</code>, math functions like <code>sqrt</code>, <code>sin</code>, <code>log</code>, booleans <code>true</code> and <code>false</code>, string functions <code>++</code>, <code>*</code>, and so on. The types sandbox tells you what exists and what types it has.</p>
</blockquote>
<a class="header" href="#semicolons-and-lambdas" id="semicolons-and-lambdas"><h1>Semicolons and lambdas</h1></a>
<p>You've probably noticed the semicolon we used in the previous part and wondered what that's for. Its meaning is actually very simple. It's used to <strong>separate the last argument</strong> to a function <em>without</em> the need to put it in parentheses. Let's see. Say we have an expression like this:</p>
<pre><code class="language-funky">string (sqrt 4.0 + sqrt 9.0)
</code></pre>
<p>We can omit the parentheses and use the semicolon instead:</p>
<pre><code class="language-funky">string; sqrt 4.0 + sqrt 9.0
</code></pre>
<blockquote>
<p><strong>Note.</strong> If you're familiar with Haskell, you'll notice that the semicolon is just like Haskell's <code>$</code> operator. That's correct. Funky uses the semicolon instead of the dollar to avoid clutter, because it's used very frequently.</p>
</blockquote>
<p>The semicolon becomes very useful when structuring code. We could write this:</p>
<pre><code class="language-funky">func main : IO =
    println &quot;A&quot; (println &quot;B&quot; (println &quot;C&quot; quit))
</code></pre>
<p>That's a completely valid code that prints three lines:</p>
<pre><code>$ funkycmd abc.fn
A
B
C
</code></pre>
<blockquote>
<p><strong>Explanation.</strong> If you're having trouble understand the code above, here's an explanation. The <code>IO</code> is a data structure that describes what the program should do. The simplest <code>IO</code> value is <code>quit</code>. It simply instructs the program to quit.</p>
<p>The type of the <code>println</code> function is <code>String -&gt; IO -&gt; IO</code>. That means that <code>println</code> takes two arguments, a <code>String</code> and an <code>IO</code>, and evaluates to an <code>IO</code>. The resulting <code>IO</code> describes a program that first prints the provided string, then does whatever the second argument says.</p>
<p>Let's look at the inner-most (last) usage of <code>println</code> in the above code: <code>println &quot;C&quot; quit</code>. This expression of type <code>IO</code> describes a program that prints the string <code>&quot;C&quot;</code> and then quits. Since it is an <code>IO</code>, we can pass it as the second argument to another <code>println</code> and we get <code>println &quot;B&quot; (println &quot;C&quot; quit)</code>. And using the same technique once again, we end up with the code above.</p>
</blockquote>
<p>But, we have a lot of parentheses there! Let's get rid of them with those semicolons:</p>
<pre><code class="language-funky">func main : IO =
    println &quot;A&quot;; println &quot;B&quot;; println &quot;C&quot;; quit
</code></pre>
<blockquote>
<p><strong>Note.</strong> We technically don't need the last semicolon as <code>quit</code> is just a single word, but we'll leave it there for <em>style</em>.</p>
</blockquote>
<p>And finally, we can split it into mutliple lines:</p>
<pre><code class="language-funky">func main : IO =
    println &quot;A&quot;;
    println &quot;B&quot;;
    println &quot;C&quot;;
    quit
</code></pre>
<p>Now that's cool! It's got lines, it's got semicolons, looks just like an imperative code! Of course, I'm joking a bit here, but it's not that bad, is it?</p>
<a class="header" href="#the-if-function" id="the-if-function"><h2>The <code>if</code> function</h2></a>
<p><strong>Booleans</strong> have type <code>Bool</code>, two values - <code>true</code> and <code>false</code> - and a handy <code>if</code> function for making a choice. What's its type? The beloved types sandbox comes to rescue:</p>
<pre><code>$ funkycmd -types
&gt; if
Bool -&gt; a -&gt; a -&gt; a
</code></pre>
<p>The little <code>a</code> is a type variable. You can replace it with any type whatsoever and <code>if</code> will conform to that type. Of course, you must replace all occurences of <code>a</code> consistently. So <code>if</code> can be used as <code>Bool -&gt; Int -&gt; Int -&gt; Int</code>, or as <code>Bool -&gt; IO -&gt; IO -&gt; IO</code>, but <strong>not</strong> as <code>Bool -&gt; Int -&gt; IO -&gt; Float</code>.</p>
<p>The <code>if</code> function checks whether the condition (the first argument) is <code>true</code> or <code>false</code>. If it's <code>true</code>, the second argument is returned. Otherwise, the third argument is returned. For example:</p>
<pre><code>&gt; if true 1 3            # evaluates to 1
Int
&gt; if (4 &lt; 1) &quot;YES&quot; &quot;NO&quot;  # evaluates to &quot;NO&quot;
List Char
</code></pre>
<blockquote>
<p><strong>Note.</strong> Comments start with the <code>#</code> symbol. Also notice that <code>String</code> and <code>List Char</code> are synonyms.</p>
</blockquote>
<p>Combining the <code>if</code> function with the semicolon, we create an <em>if, else if, else</em> chain:</p>
<pre><code class="language-funky">if (guess &gt; correct) &quot;Less.&quot;;
if (guess &lt; correct) &quot;More.&quot;;
&quot;Correct!&quot;
</code></pre>
<p>Isn't this beautiful? A single function suitable both for a one-line choices and for a series of mutually exclusive branches.</p>
<a class="header" href="#lambdas" id="lambdas"><h2>Lambdas</h2></a>
<p>Funky has a very concise syntax for anonymous functions. That's crucial because just like semicolons, anonymous functions are used all over the place. Here's how you write them:</p>
<pre><code class="language-funky">\variable result
</code></pre>
<p>That's it. A backslash, the name the variable, and an expression to evaluate to.</p>
<blockquote>
<p><strong>Important.</strong> All identifiers in Funky are allowed to contain almost arbitrary Unicode characters. That's because tokens are generally separated by whitespace. The only exceptions are the symbols <code>(</code>, <code>)</code>, <code>[</code>, <code>]</code>, <code>{</code>, <code>}</code>, <code>,</code>, <code>;</code>, <code>\</code>, and <code>#</code> that are always parsed as separate tokens.</p>
<p>Therefore, <strong>idiomatic naming</strong> in Funky is very similar to the one in LISP. Dashes <code>are-used</code> instead <code>of_underscores</code>, functions returning <code>Bool</code> (predicates) usually end with the <code>?</code> symbol, and partial functions (those that can crash) end with the <code>!</code> symbol.</p>
</blockquote>
<p>Functions of multiple arguments are just functions that take the first argument and return a function taking the rest of the arguments (currying):</p>
<pre><code class="language-funky">\x \y x + y
</code></pre>
<p>Funky uses <strong>lazy evaluation</strong>. That means that arguments to functions are only evaluated when their value is needed. For example, the factorial of 20 is never calculated here:</p>
<pre><code class="language-funky">(\n 3) (factorial 20)  # evaluates to 3
</code></pre>
<p>Also, the factorial of 10 is only computed once, not twice here:</p>
<pre><code class="language-funky">(\n n + n) (factorial 10)
</code></pre>
<a class="header" href="#the-let-function" id="the-let-function"><h2>The <code>let</code> function</h2></a>
<p>The <code>let</code> function? Not a <code>let</code> keyword? Let's verify this:</p>
<pre><code>$ funkycmd -types
&gt; let
a -&gt; (a -&gt; c) -&gt; c
</code></pre>
<blockquote>
<p><strong>Note.</strong> It really should be <code>a -&gt; (a -&gt; b) -&gt; b</code>. Will be fixed.</p>
</blockquote>
<p>Uhm, so <code>let</code> takes a value and a function. Yep, and then it passes the value to the function and evaluates to whatever the function evaluates to. Maybe a bit hard to understand, so let's see:</p>
<pre><code class="language-funky">func main : IO =
    println (string; let 7 (\x x + x));
    quit
</code></pre>
<p>See that <code>let 7 (\x x + x)</code> there? From what I've said, <code>let</code> should pass the <code>7</code> to the <code>(\x x + x)</code> function and thus the program should print <code>14</code>. And in fact that's exactly what happens:</p>
<pre><code>$ funkycmd let.fn
14
</code></pre>
<p>But as you've probably guessed, this is not the idiomatic use of <code>let</code>. Let's take a closer look:</p>
<pre><code class="language-funky">let 7 (\x x + x)
</code></pre>
<p>That's pretty ugly! There's one syntactic feature, though, that we haven't talked about yet. If a lambda is the last argument to a function, which it is in our case, we can drop the parentheses. Like this:</p>
<pre><code class="language-funky">let 7 \x x + x
</code></pre>
<p>And what now? Split it into multiple lines!</p>
<pre><code class="language-funky">let 7 \x
x + x
</code></pre>
<p>Now it's starting to look like something. It looks like we've assigned the value <code>7</code> to the variable <code>x</code> and then went on to the next code. And that's precisely how we should think about it. In fact, we can restructure our little program above like this:</p>
<pre><code class="language-funky">func main : IO =
    let 7 \x
    println (string; x + x);
    quit
</code></pre>
<p>In this case, the type of the <code>let</code> function got specialized to <code>Int -&gt; (Int -&gt; IO) -&gt; IO</code>, but the result is the same.</p>
<p>So, that's how you assign variables in Funky.</p>
<a class="header" href="#a-bit-more-about-io" id="a-bit-more-about-io"><h1>A bit more about IO</h1></a>
<p>Funky has an unusual approach to side-effects. There's no notion of them in the language itself. What looked like side-effecting functions in the previous sections (<code>println</code>, <code>quit</code>, etc.) were in fact data structure constructors. The <code>IO</code> type is <em>not magic</em> at all. It's just a plain data structure defined in the Funky language itself. Here's its definition (you can also find it in the standard library in the <code>cmd</code> folder):</p>
<pre><code class="language-funky">union IO = quit | putc Char IO | getc (Char -&gt; IO)
</code></pre>
<p>We haven't covered <code>union</code> yet but think algebraic data types (e.g. <code>data</code> in Haskell). This <code>IO</code> data structure serves as a description of what the program should do. However, in contrast with the control flow of traditional imperative languages, the <code>IO</code> data structure can be arbitrarily manipulated - e.g. it's no problem to implement input/ouput encryption just by implementing a single <code>IO -&gt; IO</code> function.</p>
<blockquote>
<p><strong>Note.</strong> The <code>IO</code> data structure is very limited. All it can express is printing and scanning characters. The thing we haven't talked about yet is that <code>funkycmd</code> is just one of the many possible <em>side-effect interpreters</em>. Specifically, <code>funkycmd</code> interprets (executes) the above <code>IO</code> data structure. There's another interpreter called <code>funkygame</code> that interprets an entirely different data structure which describes sprite-based games. You can actually make your own side-effect interpreter fairly easily. The specifics of that are explained in the <a href="">TODO</a> section.</p>
</blockquote>
<p>The <code>IO</code> looks like a linked list with two kinds of nodes (not counting <code>quit</code>). The <code>funkycmd</code> interpreter loads the <code>main</code> function, walks the <code>IO</code> nodes, and does as they say.</p>
<p>Let's talk about the nodes individually.</p>
<p><strong>Quit.</strong> We've seen this one before - it marks the end of the program.</p>
<p><strong>Putc.</strong> This node has two arguments: a <code>Char</code> and an <code>IO</code>. The <code>Char</code> is the character to be printed. The <code>IO</code> tells what should be done next.</p>
<p><strong>Getc.</strong> Now this one looks strange. It has one argument: a function. The function takes a <code>Char</code> and returns an <code>IO</code>. Here's how <code>funkycmd</code> deals with <code>getc</code>: Upon encountering the <code>getc</code> node, <code>funkycmd</code> scans a character from the standard input. Then it takes the function under <code>getc</code> and applies it to the scanned character, passes it inside. The function gives back an <code>IO</code>. This <code>IO</code> tells what should be done next.</p>
<p>Now let's see them in action!</p>
<p>How about a very exciting program that reads a character and prints it back?</p>
<pre><code class="language-funky">func main : IO =
    getc (\c putc c quit)
</code></pre>
<p>Run it:</p>
<pre><code>$ funkycmd getcputc.fn
x
x
</code></pre>
<p>It worked!</p>
<p>Now, we can structure the code better using the same tricks we used with <code>if</code> and <code>let</code>. How does this look?</p>
<pre><code class="language-funky">func main : IO =
    getc \c
    putc c;
    quit
</code></pre>
<p>Well, that's nice! The first line scans a character, the second line prints it back, the third line quits the program.</p>
<p>Wait, what would happen if we made it recursive? What if we replaced <code>quit</code> with <code>main</code>?</p>
<pre><code class="language-funky">func main : IO =
    getc \c
    putc c;
    main
</code></pre>
<p>By the looks of it, this program should print back all of its input - it's the <code>cat</code> program.</p>
<blockquote>
<p><strong>Note.</strong> But it never quits! Or does it? Currently, <code>funkycmd</code> is made to silently quit when encountering the EOF, so the program quits correctly. Of course, this behavior is not guaranteed to be kept.</p>
</blockquote>
<pre><code class="language-funky">$ funkycmd cat.fn
hello, cat!
hello, cat!
do you cat?
do you cat?
you do cat!
you do cat!
^D
</code></pre>
<p>The <code>^D</code> sequence at the end is the EOF.</p>
<a class="header" href="#scanning-more-than-one-character" id="scanning-more-than-one-character"><h2>Scanning more than one character</h2></a>
<p>The standard library gives us many goods. There's <code>print</code> and <code>println</code> that work by expanding to multiple <code>putc</code> nodes. Are there some analogous high-level functions for scanning? Sure there are! They're called, how unexpected, <code>scan</code> and <code>scanln</code>. What are their types:</p>
<pre><code>$ funkycmd -types
&gt; scan
(String -&gt; IO) -&gt; IO
&gt; scanln
(String -&gt; IO) -&gt; IO
</code></pre>
<p>Oh nice, so their type is the same as the type of <code>getc</code>, except the <code>Char</code> is changed to <code>String</code>.</p>
<p>The <code>scanln</code> function scans a whole line and gives it back to you (not including the newline character). The <code>scan</code> function is a little more clever: it reads the next &quot;word&quot; from the input - it skips all the whitespace and captures a continuous string of non-whitespace characters.</p>
<p>We'll get to use <code>scan</code> more in the next section. Here's some <code>scanln</code> for the taste:</p>
<pre><code class="language-funky">func main : IO =
    print &quot;What's your name? &quot;;
    scanln \name
    println (&quot;Hello, &quot; ++ name ++ &quot;!&quot;);
    quit
</code></pre>
<p>And there we go:</p>
<pre><code>$ funkycmd greeting.fn
What's your name? Michal Å trba
Hello, Michal Å trba!
</code></pre>
<a class="header" href="#putting-it-together-a-calculator" id="putting-it-together-a-calculator"><h1>Putting it together: a calculator</h1></a>
<p>We've covered a few basic functions, now we'll put them to the test! We'll make a little calculator. The program is simple but nicely demonstrates how all the functions we've talked about work <em>together</em>. Let's see!</p>
<p>The calculator will work something like this:</p>
<pre><code>$ funkycmd calculator.fn
2 + 2
4
9 / 2
4.5
12 * 12
144
</code></pre>
<p>It will support four operators: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>. It will only support one operator per expression.</p>
<p>The first thing will be to scan the expression. The expression consists of three words on a single line, so it'll be best to use <code>scan</code> three times:</p>
<pre><code class="language-funky">func main : IO =
    scan \x-str
    scan \op
    scan \y-str
    # TODO
</code></pre>
<p>Good. Now, <code>x-str</code> and <code>y-str</code> are strings, because that's what <code>scan</code> gives us. In order to perform computations, we need to convert them to floats first.</p>
<pre><code>$ funkycmd -types
&gt; float
Int -&gt; Float
String -&gt; Float
</code></pre>
<p>The second overload of the <code>float</code> function seems to be doing just that, so let's use it (there's an analogous function for integers called <code>int</code>):</p>
<pre><code class="language-funky">func main : IO =
    scan \x-str
    scan \op
    scan \y-str
    let (float x-str) \x
    let (float y-str) \y
    # TODO
</code></pre>
<p>We saved the converted numbers in the <code>x</code> and <code>y</code> variables.</p>
<p>Now we need to compute the result and print it. For example, if the operator is <code>+</code>, the result will be <code>string; x + y</code>. Here we can exploit the <code>if</code> function's ability to form if/else chains:</p>
<pre><code class="language-funky">if (op == &quot;+&quot;) (string; x + y);
if (op == &quot;-&quot;) (string; x - y);
if (op == &quot;*&quot;) (string; x * y);
if (op == &quot;/&quot;) (string; x / y);
&quot;invalid operator: &quot; ++ op
</code></pre>
<p>The last line becomes the result if the operator is not among the supported ones. Now that we've got the result, all that's left it to print it and continue the loop:</p>
<pre><code class="language-funky">func main : IO =
    scan \x-str
    scan \op
    scan \y-str
    let (float x-str) \x
    let (float y-str) \y
    println (
        if (op == &quot;+&quot;) (string; x + y);
        if (op == &quot;-&quot;) (string; x - y);
        if (op == &quot;*&quot;) (string; x * y);
        if (op == &quot;/&quot;) (string; x / y);
        &quot;invalid operator: &quot; ++ op
    );
    main
</code></pre>
<p><strong>And that's it!</strong> Now go and experiment yourself! When you come back, we'll start learning about making our own functions and types.</p>
<a class="header" href="#making-the-world-our-own" id="making-the-world-our-own"><h1>Making the world our own</h1></a>
<p><em>A newborn child emerges in the world of established, yet ever-changing rules, objects, communities, organizations, conventions and accepts them - the status-quo. Then later in life they learn how to bend things, and how create entirely new ones. They learn how to make the world their own.</em></p>
<p>The *pretentious* little piece above is not entirely out of place. Until now, you've been learning about a few established functions and concepts in the Funky programming language. <strong>Now we'll learn how to create our own!</strong></p>
<a class="header" href="#functions" id="functions"><h1>Functions</h1></a>
<p>So far, we've only seen one function defined: the <code>main</code> function. But even from that alone I'm sure you've already guessed how function definitions look. They're quite simple:</p>
<pre><code class="language-funky">func name : type = body
</code></pre>
<p>That's it!</p>
<p>The <strong>name</strong> can be any string of non-whitespace characters excluding keyword symbols like parentheses, a backslash, a semicolon, and a few others.</p>
<p>The <strong>type</strong> specifies the type that the function name will aquire.</p>
<p>The <strong>body</strong> is an arbitrary Funky expression, functions, lambda, etc. can be used. The only limitation is that it must conform to the type.</p>
<blockquote>
<p><strong>Details.</strong> Let's talk a bit about types.</p>
<p>As we've already learned, there are three built-in types: <code>Int</code>, <code>Float</code>, and <code>Char</code>. There are also a few types from the standard library, such as <code>Bool</code>, or <code>String</code>.</p>
<p>Then there are types that take other types as arguments - a types that are, so called, generic. The <em>most important</em> of such generic types is the function type. This is also actually built-in, but since it's a type constructor, rather than a full, distinct type, I haven't included it among the built-in types previously.</p>
<p>The function type constructor is called 'the arrow', written as: <code>-&gt;</code>. It takes two arguments, the input type on the left and the output type on the right. For example, <code>Int -&gt; Bool</code> is a function that takes an <code>Int</code> and evaluates to a <code>Bool</code>.</p>
</blockquote>
<p>So, let's define a function! Every functional language tutorial <em>must</em> include a factorial example, so let's get that behind us:</p>
<pre><code class="language-funky">func factorial : Int -&gt; Int =
    \n
    if (n &lt;= 0) 1;
    n * factorial (n - 1)

func main : IO =
    print &quot;Type a number: &quot;;
    scanln \n-str
    let (int n-str) \n
    println (string; factorial n);
    quit
</code></pre>
<p>A standard, well known, recursive factorial definition.</p>
<blockquote>
<p><strong>Note.</strong> In Funky it's a convention to put arguments on the next line after <code>=</code> in the function definition. If the function is very short, this convention may be broken and the whole definition may sit on a single line.</p>
</blockquote>
<blockquote>
<p><strong>Details.</strong> The order of definitions doesn't matter. A function doesn't have to be 'defined before use'. All that matters is that it is defined.</p>
</blockquote>
<p>Let's try it:</p>
<pre><code>$ funkycmd factorial.fn
Type a number: 5
120
</code></pre>
<p>If it gives <code>120</code> for <code>5</code> then it surely works. Let's try something bigger:</p>
<pre><code>$ funkycmd factorial.fn
Type a number: 99
933262154439441526816992388562667004907159682643816214685929638952175999932299156089414639761565182862536979208272237582511852109168640000000000000000000000
</code></pre>
<p>Whoa, that's a number! You can try entering even bigger inputs, but don't go too big... you may freeze your system.</p>
<p><strong>Now, how about functions with multiple arguments?</strong> Say we want to make a function called <code>divides</code> that tells us whether one integer divides another or not.</p>
<p>In Funky, as in many other functional languages, there are no functions of more than one argument. Instead, there are functions that return functions. A function of two arguments really is a function that takes the first argument and returns a new function. This new function remembers the first argument and takes the second one.</p>
<p>What would be the type of such a function?</p>
<p>The type <code>Int -&gt; (Int -&gt; Bool)</code> would do. It takes the first <code>Int</code>, evaluates to a function taking the second <code>Int</code> and finally evaluates to <code>Bool</code>.</p>
<p>Great, now how would we call such a function?</p>
<p>Using <code>(divides 9) 3</code> would obviously work. But, we don't really need the parentheses. If parentheses are not present, they're implicitly from the left, so <code>divides 9 3</code> is good too.</p>
<p>Furthermore, the parentheses in the type <code>Int -&gt; (Int -&gt; Bool)</code> aren't needed either. Since <code>-&gt;</code> is used infix, it's automatically parenthesized from the right, so <code>Int -&gt; Int -&gt; Bool</code> is equivalent.</p>
<blockquote>
<p><strong>Details.</strong> There are two kinds of functions in Funky: prefix and infix. Infix functions can be identified easily: they don't contain any letters. All other functions are prefix.</p>
<p>Applications of prefix functions are automatically parenthesized from the left if no explicit parenthesis are present. In all cases, <code>f x y</code> is the same as <code>(f x) y</code>.</p>
<p>Applications of infix functions are, however, automatically parenthesized from the right. All of them have the same precedence. This is to simplify programmer's life: when defining own infix functions, you won't be bothered by specifying precedence levels or associativity. So, <code>3 * 2 + 1</code> is equivalent to <code>3 * (2 + 1)</code>.</p>
</blockquote>
<p>After learning about automatic parentheses (also called left/right-associativity), here's the definition of <code>divides</code>:</p>
<pre><code class="language-funky">func divides : Int -&gt; Int -&gt; Bool =
    \m \n
    (n % m) == 0
</code></pre>
<p>The body is just two lambdas nested inside one another, which perfectly reflects the type.</p>
<p>We could've also called the function <code>/?</code>, in which case it would be an infix function. However, the name <code>divides</code> is much more descriptive.</p>
<p><strong>Function types may also contain type variables</strong>. These are distinguished from actual types by being all lower-case. Actual types must contain an upper-case character - type variables must not.</p>
<p>When a function has a type variable in its type, that means that this function is fine with whatever type instead of that variable. For example, there's this (probably controversialy named function, usually it's called <code>id</code>) function called <code>self</code>:</p>
<pre><code>$ funkycmd -types
&gt; self
a -&gt; a
</code></pre>
<p>It doesn't do anything. It just returns whatever it was passed. For example, <code>self 4</code> is <code>4</code>. Now, when we passed <code>4</code> to <code>self</code>, its type changed a bit. It specialized. It became <code>Int -&gt; Int</code>. See? We get this specialization just by replacing <code>a</code> with <code>Int</code> in the type. That's how type variables work.</p>
<a class="header" href="#overloading" id="overloading"><h2>Overloading</h2></a>
<p>Words in natural language usually don't have just one meaning: &quot;If only there was a <em>way</em> we could continue that <em>way</em>, we could've been <em>way</em> ahead of them, but in a <em>way</em>, we haven't done so bad.&quot; The previous sentence used four different meanings of the word 'way'.</p>
<p>Using same words for different, or slightly different meanings in different contexts allows for very concise and expressive speach. Imagine that we'd have to invent a brand new word every time we'd like to add a new meaning to an existing word. That would be cumbersome and unnatural.</p>
<p>Programming is no different. When designing Funky, I realized that support for function overloading brings so many benefits that I couldn't ignore it despite the initial difficulty of implementation.</p>
<p>So, let's try it!</p>
<pre><code class="language-funky">func double : Int -&gt; Int =
    \x x * 2

func double : Float -&gt; Float =
    \x x * 2.0

func main : IO =
    println (string; double 9);
    println (string; double 4.3);
    quit
</code></pre>
<p>There we go, two versions of <code>double</code>: one for <code>Int</code>s, one for <code>Float</code>s. Let's run it!</p>
<pre><code>$ funkycmd double.fn
18
8.6
</code></pre>
<p>Works like charm!</p>
<p>Now, how about defining two functions like this?</p>
<pre><code class="language-funky">func zero : Int = 0

func zero : Float = 0.0

func main : IO =
    println (string zero);
    quit
</code></pre>
<p>This time, both versions of <code>zero</code> fit the context because <code>string</code> works for both <code>Int</code>s and <code>Float</code>s. What does the type checker say?</p>
<pre><code>$ funkycmd zeros.fn
zeros.fn:6:21: ambiguous, multiple admissible types:
  Int
  Float
</code></pre>
<p>That's right, the type checker complains. We can fix this error with a type annotation. You can add an explicit type to any expression using the <code>:</code> symbol:</p>
<pre><code class="language-funky">func zero : Int = 0

func zero : Float = 0.0

func main : IO =
    println (string (zero : Int));
    quit
</code></pre>
<p>All is fine this time:</p>
<pre><code>$ funkycmd zeros.fn
0
</code></pre>
<p>Well, okay, those two <code>zero</code> functions are distinguishible by their type. But what if we put the same type?</p>
<pre><code class="language-funky">func lucky-number : Int = 7
func lucky-number : Int = 3

func main : IO =
    println (string lucky-number);
    quit
</code></pre>
<p>Which one gets printed? <code>7</code> or <code>3</code>? Make your guesses, ladies and gentlement...</p>
<p>Here's what happens:</p>
<pre><code>$ funkycmd lucky-number.fn
lucky-number.fn:2:27: function lucky-number with colliding type exists: test.fn:1:27
</code></pre>
<p>Oh, no! It didn't even let us define the second function, because its type collides with the first one.</p>
<p><strong>Funky doesn't let you overload a function if its type collides with an existing version.</strong></p>
<blockquote>
<p><strong>Details.</strong> When exactly do two types collide?</p>
<p>Do these two functions collide?</p>
<pre><code class="language-funky">func weirdo : a -&gt; a     = self
func weirdo : Int -&gt; Int = (* 2)
</code></pre>
<p>Indeed, they do! You might argue that the second one is more specific than the first one, so if both fit the context, the second one should be selected, but this doesn't fly in Funky, because it brings a whole bag of problems.</p>
<p>Instead, I chose simplicity: <strong>two types collide whenever their type variables can be substituted such that they become the same type</strong>.</p>
<p>For example: <code>a -&gt; Int</code> collides with <code>Float -&gt; a</code> (substitutes to <code>Float -&gt; Int</code>).</p>
</blockquote>
<a class="header" href="#records" id="records"><h1>Records</h1></a>
<p>Now onto creating our own types!</p>
<p>I'm sure you're familiar with <code>struct</code>s from C or <code>record</code>s from Pascal. They simply group multiple values into a single value. Records in Funky are very much the same.</p>
<p>They're defined like this:</p>
<pre><code class="language-funky">record Name = field : type, ...
</code></pre>
<p>For example:</p>
<pre><code class="language-funky">record Person =
    name : String,
    age  : Int,
</code></pre>
<blockquote>
<p><strong>Note.</strong> Trailing comma is allowed.</p>
</blockquote>
<p>The <code>Person</code> type is now a new, non-reproductive way of creating people (pretty revolutionary if you think about it). How do we create one?</p>
<p>Whenever we define a <code>record</code>, Funky <strong>generates a constructor function with the same name</strong>. Let's see!</p>
<pre><code>$ funkycmd -types person.fn
&gt; Person
String -&gt; Int -&gt; Person
</code></pre>
<p>Basically, it takes values for the name and the age and gives us a fully fledged person. Great!</p>
<pre><code class="language-funky">record Person =
    name : String,
    age  : Int,

func main : IO =
    let (Person &quot;Joe&quot; 28) \joe
    quit
</code></pre>
<p>We've got Joe! How do we use him?</p>
<p>In addition to the constructor function, Funky <strong>generates two functions per field: a getter and an updater</strong>. Name of both of the functions is the same as the name of the field:</p>
<pre><code>$ funkycmd -types person.fn
&gt; name
Person -&gt; String
(String -&gt; String) -&gt; Person -&gt; Person
</code></pre>
<p>The type <code>Person -&gt; String</code> is the getter. It works just as you'd expect:</p>
<pre><code class="language-funky">record Person =
    name : String,
    age  : Int,

func main : IO =
    let (Person &quot;Joe&quot; 28) \joe
    println (name joe);
    quit
</code></pre>
<p>Running it:</p>
<pre><code>$ funkycmd person.fn
Joe
</code></pre>
<p>The updater with the type <code>(String -&gt; String) -&gt; Person -&gt; Person</code> is a little more... funky.</p>
<p>Here's what it does: it takes a function and a person. It returns a new person that is the same as the old one, except with the field modified by the function.</p>
<p>Let's see:</p>
<pre><code class="language-funky">record Person =
    name : String,
    age  : Int,

func main : IO =
    let (Person &quot;Joe&quot; 28)       \joe
    let (name (++ &quot;, yo!&quot;) joe) \joe  # shadows the previous joe variable
    println (name joe);
    let (age (+ 1) joe) \joe          # Joe had a birthday!
    println (string; age joe);
    quit
</code></pre>
<p>And run it:</p>
<pre><code>$ funkycmd person.fn
Joe, yo!
29
</code></pre>
<blockquote>
<p><strong>Note.</strong> If you want to replace the field's value by some other value, you can use the <code>const</code> function like this: <code>name (const &quot;Joseph&quot;) joe</code> (changes the name to <code>&quot;Joseph&quot;</code>).</p>
</blockquote>
<a class="header" href="#composing-getters-and-updaters" id="composing-getters-and-updaters"><h2>Composing getters and updaters</h2></a>
<p>The signatures of the getters and the updaters are not random. They enable some really cool stuff! We'll check it out now.</p>
<p>I'll show it to you on these two records:</p>
<pre><code class="language-funky">record Point =
    x : Int,
    y : Int,

record Line =
    from : Point,
    to   : Point,
</code></pre>
<p>Okay, now, say we have a <code>Point</code>, let's call it <code>pt</code>. To get the X coordinate we do <code>x pt</code> and to get the Y coordinate we do <code>y pt</code>. Easy! To move the X coordinate 10 units to the right, we do <code>x (+ 10) pt</code> and to set the Y coordinate to 0 we do <code>y (const 0) pt</code>.</p>
<p>Okay, now say we have <code>Line</code>. Let's call it <code>line</code>. The <code>line</code> has two points: <code>from</code> and <code>to</code>. What if we want to move the X coordinate of the first point by 10?</p>
<p>Now, here comes the cool part! All we need to do it to realize, that</p>
<pre><code class="language-funky">x (+ 10)
</code></pre>
<p>is a partial application of the <code>x</code> updater and has type <code>Point -&gt; Point</code>. But, any <code>Point -&gt; Point</code> can be used in the <code>from</code> updater:</p>
<pre><code class="language-funky">from (x (+ 10)) line
</code></pre>
<p>Lastly, we can clean it up with the function composition operator:</p>
<pre><code class="language-funky">(from . x) (+ 10) line
</code></pre>
<blockquote>
<p><strong>Note.</strong> The function composition operator <code>.</code> works like this: <code>(f . g) x = f (g x)</code>. So you see we've just rewritten the previous expression using this formula.</p>
</blockquote>
<blockquote>
<p><strong>Details.</strong> In Funky, the function composition operator is overloaded a few times in the standard library, namely for when the second function takes multiple arguments. For example, one of the overloaded versions works like this: <code>(f . g) x y = f (g x y)</code>. That way, writing <code>(concat . map)</code> works exactly as you'd like to. The type checker can always tell which version fits the context.</p>
</blockquote>
<p>And that's it! That's pretty clean, isn't it?</p>
<p>Getters can be composed similarly, except in the opposite order:</p>
<pre><code class="language-funky">(y . to) line
</code></pre>
<p>That's the Y coordinate of the last point.</p>
<p>Getters and updaters also have a very important role when it comes to expressing state flow with the <code>State</code> type as we'll cover in the <a href="">TODO</a> part. In short, they enable record fields to act as mutable variables in an imperative algorithm.</p>
<a class="header" href="#unions" id="unions"><h1>Unions</h1></a>
<p>The second way of creating <em>new</em> types is unions. While a record is a collection of fields, a union defines multiple alternative forms.</p>
<p>Here's the general form:</p>
<pre><code class="language-funky">union Name = alternative argument ... | ...
</code></pre>
<p>The three dots after <code>argument</code> mean that a single alternative can contain any number of arguments (fields) and the three dots after <code>|</code> mean that a union can have any number of alternatives.</p>
<p>Unlike records, arguments for alternatives have no names, only types.</p>
<p>Here's a simple union:</p>
<pre><code class="language-funky">union Bool = true | false
</code></pre>
<p>This is the actual definition of the type <code>Bool</code> from the standard library. The alternatives have no arguments in this case.</p>
<p>Here's another example:</p>
<pre><code class="language-funky">record Point = x : Float, y : Float

union Shape =
    line Point Point   |
    circle Point Float |
</code></pre>
<blockquote>
<p><strong>Note.</strong> Trailing <code>|</code> is allowed.</p>
</blockquote>
<p>The <code>Shape</code> type has two alternatives: the <code>line</code> alternatives, which is composed of two points, and the <code>circle</code> alternatives, which has a point (the center) and a float (the radius).</p>
<p>When we define a union, Funky <strong>generates a constructor function for each alternative</strong>. The function simply takes all the arguments in order. Let's check them out!</p>
<pre><code>$ funkycmd -types shapes.fn
&gt; line
Point -&gt; Point -&gt; Shape
&gt; circle
Point -&gt; Float -&gt; Shape
&gt; line (Point 1.0 8.0) (Point 12.5 -4.9)
Shape
&gt; circle (Point 0.0 0.0) 7.0
Shape
</code></pre>
<p>They definitely work!</p>
<p><strong>To examine a <code>Shape</code> value and make a decision based on whether it's a line or a circle, Funky provides the <code>switch</code>/<code>case</code> construct.</strong> It's best shown by an example. Here's a function that calculates the length of a line or a circumference of a circle:</p>
<pre><code class="language-funky">func length : Shape -&gt; Float =
    \shape
    switch shape
    case line \from \to
        hypot (x to - x from) (y to - y from)
    case circle \center \radius
        2.0 * pi * radius
</code></pre>
<blockquote>
<p><strong>Note.</strong> The <code>hypot</code> function stands for 'hypotenuse' and is used for calculating the length of the long side of a right triangle using the Pythagorean theorem: <code>hypot x y = sqrt ((x ^ 2.0) + (y ^ 2.0))</code>.</p>
</blockquote>
<p>As you can see, the <code>switch</code>/<code>case</code> construct begins with the <code>switch</code> keyword followed by the value we're switching on. After that, we see a series of <code>case</code> branches. Each branch starts with the <code>case</code> keyword followed by the name of the alternative. That is followed by a function that takes the arguments to the alternative and evaluates to the overall result.</p>
<p>Of course, all <code>case</code> branches must evaluate to the same type: <code>Float</code>, in our case.</p>
<blockquote>
<p><strong>Note.</strong> Currently, all alternatives must be present in <code>switch</code>/<code>case</code> and they must be listed in the same order as they are in the definition of the union. This will be fixed.</p>
</blockquote>
<p><strong>The names of the alternatives can also be infix</strong> if they don't contain any letters. When they are infix, they can be placed between their arguments in the definition.</p>
<p>For example, here's a nice, recursive union for building up arithmetic expressions:</p>
<pre><code class="language-funky">union Expr =
    num Int     |
    Expr + Expr |
    Expr * Expr |
</code></pre>
<p>It's either just a number, like <code>num 12</code>, or it's an addition, or a multiplication: <code>num 12 + num 7</code>, or <code>(num 1 + num 9) * ((num 4 + num 3) + (num 2 * num 2))</code>.</p>
<blockquote>
<p><strong>Note.</strong> The alternatives can be called <code>+</code> and <code>*</code> without a problem thanks to overloading.</p>
</blockquote>
<p>To evaluate an expression like that, we make use of <code>switch</code>/<code>case</code> again:</p>
<pre><code class="language-funky">func eval : Expr -&gt; Int =
    \expr
    switch expr
    case num
        self
    case (+) \left \right
        eval left + eval right
    case (*) \left \right
        eval left * eval right
</code></pre>
<p>Have you noticed that no lambda comes after <code>case num</code>? That's because the <code>case</code> bodies need not explicitly contain lambdas, all they need is a function. In this case, <code>self</code> (the identity function) is the right choice because it just evaluates to the number under <code>num</code>.</p>
<p>Let's see if <code>eval</code> works right!</p>
<pre><code class="language-funky">union Expr =
    num Int     |
    Expr + Expr |
    Expr * Expr |

func eval : Expr -&gt; Int =
    \expr
    switch expr
    case num
        self
    case (+) \left \right
        eval left + eval right
    case (*) \left \right
        eval left * eval right

func main : IO =
    let ((num 1 + num 9) * ((num 4 + num 3) + (num 2 * num 2))) \expr
    println (string; eval expr);
    quit
</code></pre>
<p>And run it:</p>
<pre><code>$ funkycmd expr.fn
110
</code></pre>
<p>Works great!</p>
<a class="header" href="#type-variables-in-types" id="type-variables-in-types"><h2>Type variables in types</h2></a>
<p>So far we've only defined types that were concrete, with no type variables anywhere. But it's also possible (and very useful) to define <em>generic types</em>: types parameterized by one or more type variables.</p>
<p>It's really simple.</p>
<p>All we need to do is to list the type variables after the name of the type in the definition:</p>
<pre><code class="language-funky">record Pair a b =
    first  : a,
    second : b,
</code></pre>
<p>That's an actual definition of the <code>Pair</code> type from the standard library.</p>
<p>Or here's another example:</p>
<pre><code class="language-funky">union Maybe a = none | some a
</code></pre>
<p>That is, likewise, the definition of the <code>Maybe</code> type from the standard library.</p>
<p>This way, <code>Pair</code> and <code>Maybe</code> don't define a single type each. Instead, each defines a family of types: <code>Pair Int Float</code>, <code>Pair String Bool</code>, <code>Maybe (String -&gt; String)</code>, <code>Maybe (Pair Int Int)</code> all belong to those families.</p>
<blockquote>
<p><strong>Note.</strong> 'Type family' is not a concept in Funky, it's just a phrase we use to talk about types. <code>Pair</code> without its type variables filled in is always an error.</p>
</blockquote>
<a class="header" href="#aliases" id="aliases"><h1>Aliases</h1></a>
<p>Aliases are sooo simple! Too simple. All they do is they define <strong>a new name for an existing type</strong>:</p>
<pre><code class="language-funky">alias Name = type
</code></pre>
<p>That's it!</p>
<p>The <code>String</code> type is an alias:</p>
<pre><code class="language-funky">alias String = List Char
</code></pre>
<p>Therefore, <code>String</code> and <code>List Char</code> are perfect synonyms.</p>
<p>Of course, aliases <strong>can also contain type variables</strong> and have one interesting, although not very useful feature: <strong>they can be recursive</strong>. I haven't found a situation yet where a recursive alias would be needed, but I'll leave that up to you. ;)</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
